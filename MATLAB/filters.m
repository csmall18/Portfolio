% Multiple Filters
%% FILTER CODE
% Filter #1
ts = 3e-4;
fs1 = 1/ts;
fc = 770;
fdelta = 6;
prip = 0.02;
srip = 0.01;
Amps = [0,1,0];
DEV = [srip,prip,srip];
fp1 = fc - fdelta;
fp2 = fc + fdelta;
F = [697,fp1,fp2,852];
[N,Fo,Ao,w] = firpmord(F,Amps,DEV,fs1);
N = N - 11;
b = firpm(N,Fo,Ao,w);
w = -pi:pi/(5*fs1):pi;
ff = w/(2*pi)*fs1;
H = freqz(b,1,w);
tt = 0:1/fs1:(length(H)-1)/fs1;
subplot(1,2,1);
plotspec(xx,fs1,128);
DTMFfilt = conv(xx,b);
subplot(1,2,2);
plotspec(DTMFfilt,fs1,128);
%soundsc(DTMFfilt,fs1);
%% FILTER #2
ts = 3e-4;
fs = 1/ts;
fc = 770;
fdelta = 6;
prip = 0.02;
srip = 0.01;
Amps = [0,1,0];
DEV = [srip,prip,srip];
fp1 = fc - fdelta;
fp2 = fc + fdelta;
F = [697,fp1,fp2,852];
[N,Fo,Ao,w] = firpmord(F,Amps,DEV,fs);
N = N - 11;
b = firpm(N,Fo,Ao,w);
w = -pi:2*pi/10000:pi;
ff = w/(2*pi)*fs;
H = freqz(b,1,w);
plot(ff,abs(H));
%hold on
%plot (ff.*DTMFsig,abs(H));
%% FILTER #5
ts = 3e-4;
fs = 1/ts;
fc = 1209;
fdelta = 6;
prip = 0.02;
srip = 0.01;
Amps = [0,1,0];
DEV = [srip,prip,srip];
fp1 = fc - fdelta;
fp2 = fc + fdelta;
F = [fc-72,fp1,fp2,fc+83];
[N,Fo,Ao,w] = firpmord(F,Amps,DEV,fs);
N = N-10;
b = firpm(N,Fo,Ao,w);
w = -pi:2*pi/10000:pi;
ff = w/(2*pi)*fs;
H = freqz(b,1,w);
plot(ff,abs(H));
%% FILTER #3
ts = 3e-4;
fs = 1/ts;
fc = 852;
fdelta = 6;
prip = 0.02;
srip = 0.01;
Amps = [0,1,0];
DEV = [srip,prip,srip];
fp1 = fc - fdelta;
fp2 = fc + fdelta;
F = [770,fp1,fp2,941];
[N,Fo,Ao,w] = firpmord(F,Amps,DEV,fs);
N = N-10;
b = firpm(N,Fo,Ao,w);
w = -pi:2*pi/10000:pi;
ff = w/(2*pi)*fs;
H = freqz(b,1,w);
plot(ff,abs(H));
%% FILTER #6
ts = 3e-4;
fs = 1/ts;
fc = 1336;
fdelta = 6;
prip = 0.02;
srip = 0.01;
Amps = [0,1,0];
DEV = [srip,prip,srip];
fp1 = fc - fdelta;
fp2 = fc + fdelta;
F = [1209,fp1,fp2,1477];
[N,Fo,Ao,w] = firpmord(F,Amps,DEV,fs);
N = N-4;
b = firpm(N,Fo,Ao,w);
w = -pi:(2*pi)/10000:pi;
ff = w/(2*pi)*fs;
H = freqz(b,1,w);
plot(ff,abs(H));
%% FILTER #7
ts = 3e-4;
fs = 1/ts;
fc = 1477;
fdelta = 6;
prip = 0.02;
srip = 0.01;
Amps = [0,1,0];
DEV = [srip,prip,srip];
fp1 = fc - fdelta;
fp2 = fc + fdelta;
F = [1336,fp1,fp2,1633];
[N,Fo,Ao,w] = firpmord(F,Amps,DEV,fs);
N = N-3;
b = firpm(N,Fo,Ao,w);
w = -pi:(2*pi)/10000:pi;
ff = w/(2*pi)*fs;
H = freqz(b,1,w);
plot(ff,abs(H));
%% FILTER #8
ts = 3e-4;
fs1 = 1/ts;
fc = 1633;
% fdelta = 0;
prip = 0.02;
srip = 0.01;
Amps = [0,1];
DEV = [srip,prip];
% fp1 = fc - fdelta;
% fp2 = fc + fdelta;
F = [1447,fc];
[N,Fo,Ao,w] = firpmord(F,Amps,DEV,fs1);
N = N + 4;
b = firpm(N,Fo,Ao,w);
w = -pi:(2*pi)/10000:pi; %old: -pi:pi/(5*fs1):pi
ff = w/(2*pi)*fs1;
H = freqz(b,1,w);
tt = 0:1/fs1:(length(H)-1)/fs1;
% subplot(1,2,1);
plot(ff,abs(H));
%% FILTER #1
ts = 3e-4;
fs = 1/ts;
fc = 697;
fdelta = 6;
prip = 0.02;
srip = 0.01;
Amps = [0,1,0];
DEV = [srip,prip,srip];
fp1 = fc - fdelta;
fp2 = fc + fdelta;
F = [fc-72,fp1,fp2,770];
[N,Fo,Ao,w] = firpmord(F,Amps,DEV,fs);
N = N-8;
b = firpm(N,Fo,Ao,w);
w = -pi:2*pi/10000:pi;
ff = w/(2*pi)*fs;
H = freqz(b,1,w);
plot(ff,abs(H));
%% FILTER #4
ts = 3e-4;
fs = 1/ts;
fc = 941;
fdelta = 6;
prip = 0.02;
srip = 0.01;
Amps = [0,1,0];
DEV = [srip,prip,srip];
fp1 = fc - fdelta;
fp2 = fc + fdelta;
F = [fc-72,fp1,fp2,fc+83];
[N,Fo,Ao,w] = firpmord(F,Amps,DEV,fs);
N = N-10;
b = firpm(N,Fo,Ao,w);
w = -pi:2*pi/10000:pi;
ff = w/(2*pi)*fs;
H = freqz(b,1,w);
plot(ff,abs(H));